{"remainingRequest":"/Users/abadboy/Documents/works/yitaibox_web/node_modules/thread-loader/dist/cjs.js!/Users/abadboy/Documents/works/yitaibox_web/node_modules/babel-loader/lib/index.js!/Users/abadboy/Documents/works/yitaibox_web/node_modules/eslint-loader/index.js??ref--13-0!/Users/abadboy/Documents/works/yitaibox_web/src/dbchain-js-client/src/oracle.js","dependencies":[{"path":"/Users/abadboy/Documents/works/yitaibox_web/src/dbchain-js-client/src/oracle.js","mtime":1627026042242},{"path":"/Users/abadboy/Documents/works/yitaibox_web/node_modules/cache-loader/dist/cjs.js","mtime":1622543821598},{"path":"/Users/abadboy/Documents/works/yitaibox_web/node_modules/thread-loader/dist/cjs.js","mtime":1622543821656},{"path":"/Users/abadboy/Documents/works/yitaibox_web/node_modules/babel-loader/lib/index.js","mtime":1609932570543},{"path":"/Users/abadboy/Documents/works/yitaibox_web/node_modules/eslint-loader/index.js","mtime":1622543823631}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9hYmFkYm95L0RvY3VtZW50cy93b3Jrcy95aXRhaWJveF93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgeyByZXN0R2V0IH0gZnJvbSAiLi9yZXN0X2xpYiI7CmltcG9ydCB7IGNyZWF0ZUFjY2Vzc1Rva2VuIH0gZnJvbSAiLi9hY2Nlc3NfdG9rZW4iOwp2YXIgcXVlcnlSb290ID0gIi9kYmNoYWluL29yYWNsZSI7IC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vICAgICAgICAgICAgICAgICAgIC8vCi8vIG9yYWNsZSBxdWVyaWVzIC8vCi8vICAgICAgICAgICAgICAgICAgIC8vCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgpmdW5jdGlvbiBzZW5kVmVyaWZpY2F0aW9uQ29kZShfeCkgewogIHJldHVybiBfc2VuZFZlcmlmaWNhdGlvbkNvZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3NlbmRWZXJpZmljYXRpb25Db2RlKCkgewogIF9zZW5kVmVyaWZpY2F0aW9uQ29kZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShtb2JpbGUpIHsKICAgIHZhciB1cmksIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB1cmkgPSB1cmlCdWlsZGVyKCJzZW5kX3ZlcmZfY29kZSIsIG1vYmlsZSk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVzdEdldCh1cmkpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZXNwb25zZS5kYXRhLnJlc3VsdCk7CgogICAgICAgICAgY2FzZSA1OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gX3NlbmRWZXJpZmljYXRpb25Db2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHZlcmlmeVZlcmlmaWNhdGlvbkNvZGUoX3gyLCBfeDMpIHsKICByZXR1cm4gX3ZlcmlmeVZlcmlmaWNhdGlvbkNvZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX3ZlcmlmeVZlcmlmaWNhdGlvbkNvZGUoKSB7CiAgX3ZlcmlmeVZlcmlmaWNhdGlvbkNvZGUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKG1vYmlsZSwgY29kZSkgewogICAgdmFyIHVyaSwgcmVzcG9uc2U7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB1cmkgPSB1cmlCdWlsZGVyKCJ2ZXJpZnlfdmVyZl9jb2RlIiwgbW9iaWxlLCBjb2RlKTsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVzdEdldCh1cmkpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLmRhdGEucmVzdWx0KTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSk7CiAgcmV0dXJuIF92ZXJpZnlWZXJpZmljYXRpb25Db2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIHZlcmlmeUlkQ2FyZChfeDQsIF94NSkgewogIHJldHVybiBfdmVyaWZ5SWRDYXJkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF92ZXJpZnlJZENhcmQoKSB7CiAgX3ZlcmlmeUlkQ2FyZCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMobmFtZSwgaWROdW1iZXIpIHsKICAgIHZhciB1cmksIHJlc3BvbnNlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgdXJpID0gdXJpQnVpbGRlcigidmVyaWZ5X25hbWVfYW5kX2lkX251bWJlciIsIG5hbWUsIGlkTnVtYmVyKTsKICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVzdEdldCh1cmkpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLmRhdGEucmVzdWx0KTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUzKTsKICB9KSk7CiAgcmV0dXJuIF92ZXJpZnlJZENhcmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gdmVyaWZ5Q29ycEluZm8oX3g2LCBfeDcsIF94OCkgewogIHJldHVybiBfdmVyaWZ5Q29ycEluZm8uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vICAgICAgICAgICAgICAgICAgLy8KLy8gaGVscGVyIGZ1bmN0aW9ucyAvLwovLyAgICAgICAgICAgICAgICAgIC8vCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCgpmdW5jdGlvbiBfdmVyaWZ5Q29ycEluZm8oKSB7CiAgX3ZlcmlmeUNvcnBJbmZvID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChjb3JwTmFtZSwgcmVnTnVtYmVyLCBjcmVkaXRDb2RlKSB7CiAgICB2YXIgdXJpLCByZXNwb25zZTsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHVyaSA9IHVyaUJ1aWxkZXIoInZlcmlmeV9jb3JwX2luZm8iLCBjb3JwTmFtZSwgcmVnTnVtYmVyLCBjcmVkaXRDb2RlKTsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gcmVzdEdldCh1cmkpOwoKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHJlc3BvbnNlLmRhdGEucmVzdWx0KTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU0KTsKICB9KSk7CiAgcmV0dXJuIF92ZXJpZnlDb3JwSW5mby5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiB1cmlCdWlsZGVyKCkgewogIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICB9CgogIGlmIChhcmdzLmxlbmd0aCA8IDEpIHsKICAgIHRocm93ICJBdCBsZWFzdCBvbmUgcGFyYW1ldGVyIGlzIG5lZWRlZCEiOwogIH0KCiAgdmFyIGFjY2Vzc1Rva2VuID0gY3JlYXRlQWNjZXNzVG9rZW4oKTsKICBhcmdzLnNwbGljZSgxLCAwLCBhY2Nlc3NUb2tlbik7CiAgYXJncy51bnNoaWZ0KHF1ZXJ5Um9vdCk7CiAgcmV0dXJuIGFyZ3Muam9pbigiLyIpOwp9CgpleHBvcnQgeyBzZW5kVmVyaWZpY2F0aW9uQ29kZSwgdmVyaWZ5VmVyaWZpY2F0aW9uQ29kZSwgdmVyaWZ5SWRDYXJkLCB2ZXJpZnlDb3JwSW5mbyB9Ow=="},{"version":3,"sources":["/Users/abadboy/Documents/works/yitaibox_web/src/dbchain-js-client/src/oracle.js"],"names":["restGet","createAccessToken","queryRoot","sendVerificationCode","mobile","uri","uriBuilder","response","data","result","verifyVerificationCode","code","verifyIdCard","name","idNumber","verifyCorpInfo","corpName","regNumber","creditCode","args","length","accessToken","splice","unshift","join"],"mappings":";;;;AAAA,SAASA,OAAT,QAAwB,YAAxB;AACA,SAASC,iBAAT,QAAkC,gBAAlC;AAEA,IAAMC,SAAS,GAAG,iBAAlB,C,CAEA;AACA;AACA;AACA;AACA;;SAEeC,oB;;;;;kFAAf,iBAAoCC,MAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,YAAAA,GADN,GACYC,UAAU,CAAC,gBAAD,EAAmBF,MAAnB,CADtB;AAAA;AAAA,mBAEuBJ,OAAO,CAACK,GAAD,CAF9B;;AAAA;AAEME,YAAAA,QAFN;AAAA,6CAGSA,QAAQ,CAACC,IAAT,CAAcC,MAHvB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAMeC,sB;;;;;oFAAf,kBAAsCN,MAAtC,EAA8CO,IAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AACMN,YAAAA,GADN,GACYC,UAAU,CAAC,kBAAD,EAAqBF,MAArB,EAA6BO,IAA7B,CADtB;AAAA;AAAA,mBAEuBX,OAAO,CAACK,GAAD,CAF9B;;AAAA;AAEME,YAAAA,QAFN;AAAA,8CAGSA,QAAQ,CAACC,IAAT,CAAcC,MAHvB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAMeG,Y;;;;;0EAAf,kBAA4BC,IAA5B,EAAkCC,QAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AACMT,YAAAA,GADN,GACYC,UAAU,CAAC,2BAAD,EAA8BO,IAA9B,EAAoCC,QAApC,CADtB;AAAA;AAAA,mBAEuBd,OAAO,CAACK,GAAD,CAF9B;;AAAA;AAEME,YAAAA,QAFN;AAAA,8CAGSA,QAAQ,CAACC,IAAT,CAAcC,MAHvB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAMeM,c;;EAOf;AACA;AACA;AACA;AACA;;;;4EAXA,kBAA8BC,QAA9B,EAAwCC,SAAxC,EAAmDC,UAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AACMb,YAAAA,GADN,GACYC,UAAU,CAAC,kBAAD,EAAqBU,QAArB,EAA+BC,SAA/B,EAA0CC,UAA1C,CADtB;AAAA;AAAA,mBAEuBlB,OAAO,CAACK,GAAD,CAF9B;;AAAA;AAEME,YAAAA,QAFN;AAAA,8CAGSA,QAAQ,CAACC,IAAT,CAAcC,MAHvB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAaA,SAASH,UAAT,GAA6B;AAAA,oCAANa,IAAM;AAANA,IAAAA,IAAM;AAAA;;AAC3B,MAAIA,IAAI,CAACC,MAAL,GAAc,CAAlB,EAAqB;AACnB,UAAM,mCAAN;AACD;;AACD,MAAIC,WAAW,GAAGpB,iBAAiB,EAAnC;AACAkB,EAAAA,IAAI,CAACG,MAAL,CAAY,CAAZ,EAAe,CAAf,EAAkBD,WAAlB;AACAF,EAAAA,IAAI,CAACI,OAAL,CAAarB,SAAb;AACA,SAAOiB,IAAI,CAACK,IAAL,CAAU,GAAV,CAAP;AACD;;AAED,SAASrB,oBAAT,EAA+BO,sBAA/B,EAAuDE,YAAvD,EAAqEG,cAArE","sourcesContent":["import { restGet } from \"./rest_lib\";\nimport { createAccessToken } from \"./access_token\";\n\nconst queryRoot = \"/dbchain/oracle\";\n\n///////////////////////\n//                   //\n// oracle queries //\n//                   //\n///////////////////////\n\nasync function sendVerificationCode(mobile) {\n  var uri = uriBuilder(\"send_verf_code\", mobile);\n  var response = await restGet(uri);\n  return response.data.result\n}\n\nasync function verifyVerificationCode(mobile, code) {\n  var uri = uriBuilder(\"verify_verf_code\", mobile, code);\n  var response = await restGet(uri);\n  return response.data.result\n}\n\nasync function verifyIdCard(name, idNumber) {\n  var uri = uriBuilder(\"verify_name_and_id_number\", name, idNumber);\n  var response = await restGet(uri);\n  return response.data.result\n}\n\nasync function verifyCorpInfo(corpName, regNumber, creditCode) {\n  var uri = uriBuilder(\"verify_corp_info\", corpName, regNumber, creditCode);\n  var response = await restGet(uri);\n  return response.data.result\n}\n\n\n//////////////////////\n//                  //\n// helper functions //\n//                  //\n//////////////////////\n\nfunction uriBuilder(...args) {\n  if (args.length < 1) {\n    throw \"At least one parameter is needed!\";\n  }\n  var accessToken = createAccessToken();\n  args.splice(1, 0, accessToken);\n  args.unshift(queryRoot);\n  return args.join(\"/\");\n}\n\nexport { sendVerificationCode, verifyVerificationCode, verifyIdCard, verifyCorpInfo };\n"]}]}